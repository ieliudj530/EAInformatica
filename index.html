<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8" />
    <title>EAInformática | Sistema de Gestão</title>
    <style>
        body { font-family: Arial; background: #f5f5f5; margin: 0; padding: 0; }
        header { background: #2c3e50; color: white; padding: 1rem; text-align: center; }
        .container { padding: 1rem; }
        table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
        th, td { border: 1px solid #ccc; padding: 0.5rem; text-align: left; }
        th { background: #34495e; color: white; }
        input, button { padding: 0.5rem; margin: 0.3rem 0; width: 100%; box-sizing: border-box; }
        button { background-color: #2c3e50; color: white; border: none; cursor: pointer; }
        button:hover { background-color: #1a252f; }
    </style>
</head>
<body>
<header>
    <h1>EAInformática - Sistema de Gestão</h1>
</header>

<div class="container">
    <h2>Adicionar Cliente</h2>
    <input type="text" id="nome" placeholder="Nome do cliente" />
    <input type="text" id="cpf" placeholder="CPF/CNPJ" />
    <input type="email" id="email" placeholder="Email" />
    <button onclick="adicionarCliente()">Salvar Cliente</button>

    <h2>Lista de Clientes</h2>
    <table id="tabelaClientes">
        <thead>
        <tr>
            <th>Nome</th>
            <th>CPF/CNPJ</th>
            <th>Email</th>
        </tr>
        </thead>
        <tbody>
        <!-- Dados serão inseridos aqui -->
        </tbody>
    </table>
</div>

<script>
    const urlWebhook = "https://script.google.com/macros/library/d/1UET7gz_OXDalQuroEbMFLmUQP7hDfvEDsoRtwcqeD37yHFEsmMotf1SO/1";

    async function carregarClientes() {
      try {
        const res = await fetch(urlWebhook);
        const data = await res.json();

        const tbody = document.querySelector('#tabelaClientes tbody');
        tbody.innerHTML = '';

        data.slice(1).forEach(row => {
          const tr = document.createElement('tr');
          row.forEach(cell => {
            const td = document.createElement('td');
            td.textContent = cell;
            tr.appendChild(td);
          });
          tbody.appendChild(tr);
        });
      } catch (error) {
        console.error('Erro ao carregar clientes:', error);
        alert('Não foi possível carregar os dados.');
      }
    }

    async function adicionarCliente() {
      const nome = document.getElementById('nome').value.trim();
      const cpf = document.getElementById('cpf').value.trim();
      const email = document.getElementById('email').value.trim();

      if (!nome || !cpf || !email) {
        alert('Por favor preencha todos os campos');
        return;
      }

      try {
        await fetch(urlWebhook, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ nome, cpf, email })
        });
        alert('Cliente salvo com sucesso!');
        document.getElementById('nome').value = '';
        document.getElementById('cpf').value = '';
        document.getElementById('email').value = '';
        carregarClientes();
      } catch (error) {
        alert('Erro ao salvar cliente');
        console.error(error);
      }
    }

    carregarClientes();
</script>
</body>
</html>